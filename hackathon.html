<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Rainfall</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #000;
            color: #33ff33;
            margin: 0;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        h1 {
            font-size: 32px;
            text-shadow: 0 0 10px #33ff33;
        }
        
        .content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .left-panel, .right-panel {
            flex: 1;
            min-width: 300px;
        }
        
        .matrix-container {
            position: relative;
            height: 400px;
            border: 1px solid #33ff33;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 0 15px rgba(51, 255, 51, 0.5);
        }
        
        .column {
            position: absolute;
            bottom: 0;
            width: 30px;
            height: 100%;
            border-right: 1px dotted #33ff33;
            box-sizing: border-box;
        }
        
        .raindrop {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #33ff33;
            border-radius: 50%;
            box-shadow: 0 0 5px #33ff33;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .active-drop {
            opacity: 1;
        }
        
        .controls {
            margin-bottom: 20px;
        }
        
        .timestamp-slider {
            width: 100%;
            margin-top: 10px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
        }
        
        input, button {
            background-color: #111;
            color: #33ff33;
            border: 1px solid #33ff33;
            padding: 8px;
            margin: 5px 0;
            width: 100%;
        }
        
        button {
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #222;
        }
        
        .stats {
            background-color: rgba(0, 20, 0, 0.7);
            padding: 15px;
            border: 1px solid #33ff33;
            margin-bottom: 20px;
        }
        
        .code-container {
            background-color: rgba(0, 20, 0, 0.7);
            padding: 15px;
            border: 1px solid #33ff33;
            overflow-x: auto;
            height: 400px;
            white-space: pre;
        }
        
        .falling-character {
            position: absolute;
            color: #33ff33;
            font-size: 14px;
            opacity: 0.8;
            user-select: none;
            animation: fallAnimation linear infinite;
        }
        
        @keyframes fallAnimation {
            to {
                transform: translateY(400px);
            }
        }
        
        .timestamp-display {
            font-size: 24px;
            text-align: center;
            margin: 10px 0;
            text-shadow: 0 0 5px #33ff33;
        }
        
        .rain-count-display {
            font-size: 20px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Digital Rainfall Visualizer</h1>
        </div>
        
        <div class="content">
            <div class="left-panel">
                <div class="stats">
                    <h2>Problem Setup</h2>
                    <div class="input-group">
                        <label for="columns">Number of Columns (N):</label>
                        <input type="number" id="columns" min="1" max="20" value="5">
                        
                        <label for="raindrops">Number of Raindrops (M):</label>
                        <input type="number" id="raindrops" min="1" max="50" value="6">
                        
                        <button id="generate-btn">Generate Random Data</button>
                        <button id="custom-btn">Enter Custom Data</button>
                        <textarea id="custom-data" rows="6" style="display:none; width: 100%; margin-top: 10px; background-color: #111; color: #33ff33; border: 1px solid #33ff33;" placeholder="Enter data in format:
timestamp column
timestamp column
..."></textarea>
                        <button id="submit-custom" style="display:none;">Submit Custom Data</button>
                    </div>
                </div>
                
                <div class="stats">
                    <h2>Results</h2>
                    <div id="result">Maximum columns with drops at the same timestamp: <span id="max-count">0</span></div>
                    <div class="rain-count-display">Columns with drops at timestamp <span id="current-timestamp">0</span>: <span id="current-count">0</span></div>
                </div>
                
                <div class="controls">
                    <h2>Timestamp Control</h2>
                    <div class="timestamp-display">Timestamp: <span id="timestamp-value">0</span></div>
                    <input type="range" class="timestamp-slider" id="timestamp-slider" min="0" max="10" value="0" step="1">
                    <button id="play-btn">▶ Play Animation</button>
                </div>
            </div>
            
            <div class="right-panel">
                <div class="matrix-container" id="matrix">
                    <!-- Columns will be generated by JS -->
                </div>
                
                <div class="code-container" id="code">
function solveDrainfall(n, drops) {
    // Dictionary to store: timestamp → set of columns
    const timeToColumns = {};

    // Process each drop
    for (const [time, column] of drops) {
        if (!timeToColumns[time]) {
            timeToColumns[time] = new Set();
        }
        timeToColumns[time].add(column);
    }

    // Find the maximum number of columns hit at the same time
    let maxColumns = 0;
    for (const time in timeToColumns) {
        maxColumns = Math.max(maxColumns, timeToColumns[time].size);
    }

    return {
        maxColumns,
        timeToColumns
    };
}
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM elements
        const columnsInput = document.getElementById('columns');
        const raindropsInput = document.getElementById('raindrops');
        const generateBtn = document.getElementById('generate-btn');
        const customBtn = document.getElementById('custom-btn');
        const customData = document.getElementById('custom-data');
        const submitCustomBtn = document.getElementById('submit-custom');
        const matrixContainer = document.getElementById('matrix');
        const timestampSlider = document.getElementById('timestamp-slider');
        const timestampValue = document.getElementById('timestamp-value');
        const maxCountElement = document.getElementById('max-count');
        const currentTimestampElement = document.getElementById('current-timestamp');
        const currentCountElement = document.getElementById('current-count');
        const playBtn = document.getElementById('play-btn');
        
        // State variables
        let drops = [];
        let columnCount = 5;
        let maxTimestamp = 0;
        let timeToColumns = {};
        let columnWidth = 0;
        let animationInterval = null;
        
        // Initialize matrix characters for background effect
        const matrixChars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$+-*/=%\"'#&_(),.;:?!\\|{}<>[]^~";
        
        // Initialize the matrix
        function initMatrix() {
            matrixContainer.innerHTML = '';
            columnWidth = matrixContainer.clientWidth / columnCount;
            
            // Add columns
            for (let i = 0; i < columnCount; i++) {
                const column = document.createElement('div');
                column.className = 'column';
                column.style.left = `${i * columnWidth + columnWidth/2}px`;
                column.style.width = `${columnWidth}px`;
                matrixContainer.appendChild(column);
                
                // Add column number at the bottom
                const columnNumber = document.createElement('div');
                columnNumber.style.position = 'absolute';
                columnNumber.style.bottom = '5px';
                columnNumber.style.width = '100%';
                columnNumber.style.textAlign = 'center';
                columnNumber.innerText = i + 1;
                column.appendChild(columnNumber);
            }
            
            // Add raindrops
            drops.forEach(([timestamp, column]) => {
                const drop = document.createElement('div');
                drop.className = 'raindrop';
                drop.dataset.timestamp = timestamp;
                drop.dataset.column = column;
                
                // Position the drop
                const xPos = (column - 1) * columnWidth + columnWidth/2;
                const yPos = matrixContainer.clientHeight * 0.8 * (1 - timestamp / (maxTimestamp + 1));
                
                drop.style.left = `${xPos}px`;
                drop.style.top = `${yPos}px`;
                
                matrixContainer.appendChild(drop);
            });
            
            // Start matrix character animation
            startMatrixAnimation();
        }
        
        function startMatrixAnimation() {
            // Create falling characters for matrix effect
            for (let i = 0; i < columnCount * 3; i++) {
                setTimeout(() => {
                    createFallingCharacter();
                }, Math.random() * 2000);
            }
        }
        
        function createFallingCharacter() {
            const character = document.createElement('div');
            character.className = 'falling-character';
            
            // Random position
            const xPos = Math.random() * matrixContainer.clientWidth;
            character.style.left = `${xPos}px`;
            character.style.top = '-20px';
            
            // Random character
            character.innerText = matrixChars[Math.floor(Math.random() * matrixChars.length)];
            
            // Random speed
            const duration = 3 + Math.random() * 5;
            character.style.animationDuration = `${duration}s`;
            
            matrixContainer.appendChild(character);
            
            // Remove after animation
            setTimeout(() => {
                if (character.parentNode) {
                    character.parentNode.removeChild(character);
                }
                createFallingCharacter(); // Create a new one
            }, duration * 1000);
        }
        
        // Generate random data
        function generateRandomData() {
            columnCount = parseInt(columnsInput.value);
            const raindropCount = parseInt(raindropsInput.value);
            
            drops = [];
            for (let i = 0; i < raindropCount; i++) {
                const timestamp = Math.floor(Math.random() * 10) + 1;
                const column = Math.floor(Math.random() * columnCount) + 1;
                drops.push([timestamp, column]);
            }
            
            processData();
        }
        
        // Process data and update visualization
        function processData() {
            // Sort drops by timestamp
            drops.sort((a, b) => a[0] - b[0]);
            
            // Find max timestamp
            maxTimestamp = drops.reduce((max, [timestamp]) => Math.max(max, timestamp), 0);
            
            // Update slider range
            timestampSlider.max = maxTimestamp;
            timestampSlider.value = 0;
            updateTimestampDisplay(0);
            
            // Solve the problem
            const solution = solveDrainfall(columnCount, drops);
            maxCountElement.textContent = solution.maxColumns;
            timeToColumns = solution.timeToColumns;
            
            // Initialize visualization
            initMatrix();
        }
        
        // Function to solve the digital rainfall problem
        function solveDrainfall(n, drops) {
            // Dictionary to store: timestamp → set of columns
            const timeToColumns = {};
            
            // Process each drop
            for (const [time, column] of drops) {
                if (!timeToColumns[time]) {
                    timeToColumns[time] = new Set();
                }
                timeToColumns[time].add(column);
            }
            
            // Find the maximum number of columns hit at the same time
            let maxColumns = 0;
            for (const time in timeToColumns) {
                maxColumns = Math.max(maxColumns, timeToColumns[time].size);
            }
            
            return {
                maxColumns,
                timeToColumns
            };
        }
        
        // Update timestamp display and visualization
        function updateTimestampDisplay(timestamp) {
            timestampValue.textContent = timestamp;
            currentTimestampElement.textContent = timestamp;
            
            // Hide all raindrops
            document.querySelectorAll('.raindrop').forEach(drop => {
                drop.classList.remove('active-drop');
            });
            
            // Show only drops for current timestamp
            document.querySelectorAll(`.raindrop[data-timestamp="${timestamp}"]`).forEach(drop => {
                drop.classList.add('active-drop');
            });
            
            // Update current count
            const currentCount = timeToColumns[timestamp] ? timeToColumns[timestamp].size : 0;
            currentCountElement.textContent = currentCount;
        }
        
        // Event listeners
        generateBtn.addEventListener('click', generateRandomData);
        
        customBtn.addEventListener('click', () => {
            customData.style.display = customData.style.display === 'none' ? 'block' : 'none';
            submitCustomBtn.style.display = customData.style.display;
        });
        
        submitCustomBtn.addEventListener('click', () => {
            const lines = customData.value.trim().split('\n');
            if (lines.length < 1) return;
            
            const firstLine = lines[0].trim().split(/\s+/);
            if (firstLine.length < 2) return;
            
            columnCount = parseInt(firstLine[0]);
            const raindropCount = parseInt(firstLine[1]);
            
            drops = [];
            for (let i = 1; i <= raindropCount && i < lines.length; i++) {
                const [timestamp, column] = lines[i].trim().split(/\s+/).map(Number);
                drops.push([timestamp, column]);
            }
            
            processData();
            customData.style.display = 'none';
            submitCustomBtn.style.display = 'none';
        });
        
        timestampSlider.addEventListener('input', () => {
            const timestamp = parseInt(timestampSlider.value);
            updateTimestampDisplay(timestamp);
        });
        
        playBtn.addEventListener('click', () => {
            if (animationInterval) {
                clearInterval(animationInterval);
                animationInterval = null;
                playBtn.textContent = '▶ Play Animation';
                return;
            }
            
            playBtn.textContent = '⏸ Pause Animation';
            let currentTimestamp = parseInt(timestampSlider.value);
            
            animationInterval = setInterval(() => {
                currentTimestamp = (currentTimestamp + 1) % (maxTimestamp + 1);
                if (currentTimestamp === 0) currentTimestamp = 1;
                
                timestampSlider.value = currentTimestamp;
                updateTimestampDisplay(currentTimestamp);
                
                if (currentTimestamp === maxTimestamp) {
                    setTimeout(() => {
                        clearInterval(animationInterval);
                        animationInterval = null;
                        playBtn.textContent = '▶ Play Animation';
                    }, 1000);
                }
            }, 1000);
        });
        
        // Initialize on load
        window.addEventListener('load', () => {
            // Sample data from the problem statement
            drops = [
                [1, 1],
                [1, 2],
                [2, 2],
                [2, 3],
                [2, 4],
                [3, 5]
            ];
            columnCount = 5;
            
            processData();
        });
        
        // Resize handling
        window.addEventListener('resize', () => {
            initMatrix();
        });
    </script>
</body>
</html>